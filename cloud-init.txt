#cloud-config
write_files:
  - path: /root/.config/nvim/coc-settings.json
    content: |
        {
          "languageserver": {
                  "golang": {
                          "command": "gopls",
                          "rootPatterns": ["go.mod", ".vim/", ".git/", ".hg/"],
                          "filetypes": ["go"]
                  }
          }
        }
runcmd:
  - curl -L https://github.com/neovim/neovim/releases/download/v0.6.1/nvim.appimage -o nvim && chmod u+x nvim && mv nvim /usr/bin
  - curl -Lo /root/.config/nvim/init.vim  --create-dirs https://raw.githubusercontent.com/ert485/cloud/master/image_starters/vultr-vim-dev-golang-2022-01/starting_files/init.vim
  - curl -Lo /root/.bashrc https://raw.githubusercontent.com/ert485/cloud/master/image_starters/vultr-vim-dev-golang-2022-01/starting_files/.bashrc
  - curl -sLo install-node install-node.vercel.app/lts && chmod +x install-node && ./install-node -y && rm install-node
  - curl -fLo /root/.local/share/nvim/site/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  - vim +'PlugInstall --sync' +GoInstallBinaries +'CocInstall coc-json' +qa
package_upgrade: true
packages:
  - golang-go
power_state:
  timeout: 300
  delay: "+1"
  message: Rebooting in one minute.
  mode: reboot
